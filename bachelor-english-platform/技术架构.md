# æŠ€æœ¯æ¶æ„

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„æ¦‚è¿°

### é«˜å±‚æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯          â”‚    â”‚   åç«¯API       â”‚    â”‚   æ•°æ®åº“        â”‚
â”‚   (Next.js)     â”‚â—„â”€â”€â–ºâ”‚   (Express.js)  â”‚â—„â”€â”€â–ºâ”‚   (MySQL)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CDN/é™æ€      â”‚    â”‚   ç¼“å­˜å±‚        â”‚    â”‚   æ–‡ä»¶å­˜å‚¨      â”‚
â”‚   (Vercel)      â”‚    â”‚   (Redis)       â”‚    â”‚   (AWS S3)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ å‰ç«¯æ¶æ„

### æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Next.js 14 with App Router
- **è¯­è¨€**: TypeScript
- **æ ·å¼**: Tailwind CSS + Ant Design
- **çŠ¶æ€ç®¡ç†**: Zustand + React Query
- **UIç»„ä»¶**: Ant Design (ä¸»è¦)
- **å›¾æ ‡**: Ant Design Icons + Lucide React
- **åŠ¨ç”»**: Framer Motion
- **æµ‹è¯•**: Jest + React Testing Library

### é¡¹ç›®ç»“æ„
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (auth)/            # è®¤è¯è·¯ç”±ç»„
â”‚   â”‚   â”œâ”€â”€ (dashboard)/       # ä»ªè¡¨æ¿è·¯ç”±ç»„
â”‚   â”‚   â”œâ”€â”€ globals.css        # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ layout.tsx         # æ ¹å¸ƒå±€
â”‚   â”‚   â””â”€â”€ page.tsx           # é¦–é¡µ
â”‚   â”œâ”€â”€ components/            # å¯é‡ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ui/               # åŸºç¡€UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ forms/            # è¡¨å•ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ learning/         # å­¦ä¹ ç‰¹å®šç»„ä»¶
â”‚   â”‚   â””â”€â”€ layout/           # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰Reacté’©å­
â”‚   â”œâ”€â”€ lib/                  # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ stores/               # Zustandå­˜å‚¨
â”‚   â”œâ”€â”€ types/                # TypeScriptç±»å‹å®šä¹‰
â”‚   â””â”€â”€ utils/                # è¾…åŠ©å‡½æ•°
â”œâ”€â”€ public/                   # é™æ€èµ„æº
â”œâ”€â”€ tailwind.config.js        # Tailwindé…ç½®
â”œâ”€â”€ next.config.js           # Next.jsé…ç½®
â””â”€â”€ package.json
```

### ç»„ä»¶æ¶æ„
```typescript
// ç»„ä»¶å±‚æ¬¡ç»“æ„ç¤ºä¾‹
App
â”œâ”€â”€ Layout
â”‚   â”œâ”€â”€ Header
â”‚   â”œâ”€â”€ Sidebar
â”‚   â””â”€â”€ Footer
â”œâ”€â”€ AuthProvider
â”œâ”€â”€ ThemeProvider
â””â”€â”€ Routes
    â”œâ”€â”€ HomePage
    â”œâ”€â”€ LearningCenter
    â”‚   â”œâ”€â”€ VocabularyModule
    â”‚   â”œâ”€â”€ GrammarModule
    â”‚   â”œâ”€â”€ ReadingModule
    â”‚   â”œâ”€â”€ WritingModule
    â”‚   â””â”€â”€ TranslationModule
    â””â”€â”€ Dashboard
        â”œâ”€â”€ ProgressOverview
        â”œâ”€â”€ Analytics
        â””â”€â”€ Settings
```

### çŠ¶æ€ç®¡ç†ç­–ç•¥
```typescript
// Zustandå­˜å‚¨
interface AppState {
  user: User | null;
  theme: 'light' | 'dark';
  sidebarCollapsed: boolean;
}

interface LearningState {
  currentModule: string;
  progress: ProgressData;
  achievements: Achievement[];
}

// React Queryç”¨äºæœåŠ¡å™¨çŠ¶æ€
const useVocabulary = (level: string) => {
  return useQuery({
    queryKey: ['vocabulary', level],
    queryFn: () => fetchVocabulary(level),
    staleTime: 5 * 60 * 1000, // 5åˆ†é’Ÿ
  });
};
```

### Ant Designé›†æˆ
```typescript
// ä¸»é¢˜é…ç½®
const theme = {
  token: {
    colorPrimary: '#1890ff',
    borderRadius: 6,
    fontSize: 14,
  },
  components: {
    Button: {
      borderRadius: 6,
    },
    Card: {
      borderRadius: 8,
    },
  },
};

// ä½¿ç”¨Ant Designçš„è‡ªå®šä¹‰ç»„ä»¶
const WordCard: React.FC<WordCardProps> = ({ word }) => {
  return (
    <Card className="word-card">
      <Card.Meta
        title={word.word}
        description={word.pronunciation}
      />
      <Button type="primary" onClick={handleFlip}>
        æ˜¾ç¤ºå«ä¹‰
      </Button>
    </Card>
  );
};
```

## ğŸ”§ åç«¯æ¶æ„

### æŠ€æœ¯æ ˆ
- **è¿è¡Œæ—¶**: Node.js 18+
- **æ¡†æ¶**: Express.js
- **è¯­è¨€**: TypeScript
- **ORM**: Prisma
- **æ•°æ®åº“**: MySQL 8.0
- **ç¼“å­˜**: Redis 7
- **è®¤è¯**: JWT + Passport.js
- **éªŒè¯**: Zod
- **æµ‹è¯•**: Jest + Supertest

### é¡¹ç›®ç»“æ„
```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/          # è¯·æ±‚å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”œâ”€â”€ user.controller.ts
â”‚   â”‚   â”œâ”€â”€ vocabulary.controller.ts
â”‚   â”‚   â””â”€â”€ learning.controller.ts
â”‚   â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”‚   â”œâ”€â”€ vocabulary.service.ts
â”‚   â”‚   â””â”€â”€ learning.service.ts
â”‚   â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.model.ts
â”‚   â”‚   â”œâ”€â”€ vocabulary.model.ts
â”‚   â”‚   â””â”€â”€ progress.model.ts
â”‚   â”œâ”€â”€ routes/              # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth.routes.ts
â”‚   â”‚   â”œâ”€â”€ user.routes.ts
â”‚   â”‚   â”œâ”€â”€ vocabulary.routes.ts
â”‚   â”‚   â””â”€â”€ learning.routes.ts
â”‚   â”œâ”€â”€ middleware/          # Expressä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.middleware.ts
â”‚   â”‚   â”œâ”€â”€ validation.middleware.ts
â”‚   â”‚   â””â”€â”€ error.middleware.ts
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ database.ts
â”‚   â”‚   â”œâ”€â”€ redis.ts
â”‚   â”‚   â””â”€â”€ helpers.ts
â”‚   â””â”€â”€ types/               # TypeScriptç±»å‹
â”‚       â”œâ”€â”€ auth.types.ts
â”‚       â”œâ”€â”€ user.types.ts
â”‚       â””â”€â”€ learning.types.ts
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma        # æ•°æ®åº“æ¨¡å¼
â”‚   â”œâ”€â”€ migrations/          # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ seed.ts              # ç§å­æ•°æ®
â”œâ”€â”€ tests/                   # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ .env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ package.json
```

### APIè®¾è®¡
```typescript
// RESTful APIç»“æ„
/api/v1
â”œâ”€â”€ /auth
â”‚   â”œâ”€â”€ POST /register
â”‚   â”œâ”€â”€ POST /login
â”‚   â”œâ”€â”€ POST /logout
â”‚   â”œâ”€â”€ POST /refresh
â”‚   â””â”€â”€ POST /forgot-password
â”œâ”€â”€ /users
â”‚   â”œâ”€â”€ GET /profile
â”‚   â”œâ”€â”€ PUT /profile
â”‚   â”œâ”€â”€ GET /progress
â”‚   â””â”€â”€ GET /achievements
â”œâ”€â”€ /vocabulary
â”‚   â”œâ”€â”€ GET /words
â”‚   â”œâ”€â”€ GET /words/:id
â”‚   â”œâ”€â”€ POST /study
â”‚   â”œâ”€â”€ GET /review
â”‚   â””â”€â”€ POST /test
â”œâ”€â”€ /grammar
â”‚   â”œâ”€â”€ GET /lessons
â”‚   â”œâ”€â”€ GET /exercises
â”‚   â””â”€â”€ POST /submit
â”œâ”€â”€ /reading
â”‚   â”œâ”€â”€ GET /passages
â”‚   â”œâ”€â”€ GET /questions
â”‚   â””â”€â”€ POST /answers
â”œâ”€â”€ /writing
â”‚   â”œâ”€â”€ POST /submit
â”‚   â”œâ”€â”€ GET /feedback
â”‚   â””â”€â”€ GET /templates
â”œâ”€â”€ /translation
â”‚   â”œâ”€â”€ GET /exercises
â”‚   â””â”€â”€ POST /submit
â””â”€â”€ /analytics
    â”œâ”€â”€ GET /progress
    â”œâ”€â”€ GET /performance
    â””â”€â”€ GET /recommendations
```

### æ•°æ®åº“æ¨¡å¼
```prisma
// Prismaæ¨¡å¼ç¤ºä¾‹ (MySQL)
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  username  String   @unique
  password  String
  avatar    String?
  level     String   @default("beginner")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // å…³ç³»
  progress     LearningProgress[]
  vocabulary   UserVocabulary[]
  achievements Achievement[]
  testRecords  TestRecord[]

  @@map("users")
}

model Vocabulary {
  id            String  @id @default(cuid())
  word          String  @unique
  pronunciation String?
  meaning       String
  partOfSpeech  String?
  difficulty    Int     @default(1)
  examples      Json?
  audioUrl      String?
  createdAt     DateTime @default(now())

  // å…³ç³»
  userVocabulary UserVocabulary[]

  @@map("vocabulary")
}

model UserVocabulary {
  id            String     @id @default(cuid())
  userId        String
  vocabularyId  String
  masteryLevel  Int        @default(0)
  reviewCount   Int        @default(0)
  lastReviewed  DateTime?
  nextReview    DateTime?
  createdAt     DateTime   @default(now())

  // å…³ç³»
  user      User      @relation(fields: [userId], references: [id])
  vocabulary Vocabulary @relation(fields: [vocabularyId], references: [id])

  @@unique([userId, vocabularyId])
  @@map("user_vocabulary")
}
```

## ğŸ—„ï¸ æ•°æ®åº“æ¶æ„

### æ•°æ®åº“è®¾è®¡åŸåˆ™
- **è§„èŒƒåŒ–**: é€‚å½“çš„æ•°æ®åº“è§„èŒƒåŒ–
- **ç´¢å¼•**: æ€§èƒ½çš„æˆ˜ç•¥æ€§ç´¢å¼•
- **å…³ç³»**: æ¸…æ™°çš„å¤–é”®å…³ç³»
- **çº¦æŸ**: æ•°æ®å®Œæ•´æ€§çº¦æŸ
- **è¿ç§»**: ç‰ˆæœ¬æ§åˆ¶çš„æ¨¡å¼æ›´æ”¹

### æ ¸å¿ƒè¡¨
```sql
-- ç”¨æˆ·å’Œè®¤è¯
users
user_sessions
user_profiles

-- å­¦ä¹ å†…å®¹
vocabulary
grammar_lessons
reading_passages
writing_prompts
translation_exercises

-- å­¦ä¹ è¿›åº¦
learning_progress
user_vocabulary
user_achievements
test_records

-- ç¤¾äº¤åŠŸèƒ½
study_groups
discussions
user_follows
```

### æ€§èƒ½ä¼˜åŒ–
```sql
-- æ€§èƒ½ç´¢å¼•
CREATE INDEX idx_user_email ON users(email);
CREATE INDEX idx_vocabulary_difficulty ON vocabulary(difficulty);
CREATE INDEX idx_user_vocabulary_user_id ON user_vocabulary(user_id);
CREATE INDEX idx_user_vocabulary_next_review ON user_vocabulary(next_review);

-- å¤åˆç´¢å¼•
CREATE INDEX idx_user_progress_module ON learning_progress(user_id, module_type);
CREATE INDEX idx_test_records_user_date ON test_records(user_id, completed_at);
```

## ğŸ” å®‰å…¨æ¶æ„

### è®¤è¯ä¸æˆæƒ
```typescript
// JWTè®¤è¯
interface JWTPayload {
  userId: string;
  email: string;
  role: string;
  iat: number;
  exp: number;
}

// åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
enum UserRole {
  STUDENT = 'student',
  TEACHER = 'teacher',
  ADMIN = 'admin'
}

// å—ä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶
const authenticateToken = (req: Request, res: Response, next: NextFunction) => {
  const token = req.headers.authorization?.split(' ')[1];
  
  if (!token) {
    return res.status(401).json({ error: 'éœ€è¦è®¿é—®ä»¤ç‰Œ' });
  }
  
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET!) as JWTPayload;
    req.user = decoded;
    next();
  } catch (error) {
    return res.status(403).json({ error: 'æ— æ•ˆä»¤ç‰Œ' });
  }
};
```

### æ•°æ®éªŒè¯
```typescript
// ZodéªŒè¯æ¨¡å¼
const registerSchema = z.object({
  email: z.string().email(),
  username: z.string().min(3).max(20),
  password: z.string().min(8),
  confirmPassword: z.string()
}).refine((data) => data.password === data.confirmPassword, {
  message: "å¯†ç ä¸åŒ¹é…",
  path: ["confirmPassword"],
});

const vocabularySchema = z.object({
  word: z.string().min(1),
  meaning: z.string().min(1),
  pronunciation: z.string().optional(),
  partOfSpeech: z.string().optional(),
  difficulty: z.number().min(1).max(5),
  examples: z.array(z.object({
    sentence: z.string(),
    translation: z.string()
  })).optional()
});
```

## ğŸš€ éƒ¨ç½²æ¶æ„

### å‰ç«¯éƒ¨ç½² (Vercel)
```yaml
# vercel.json
{
  "framework": "nextjs",
  "buildCommand": "npm run build",
  "outputDirectory": ".next",
  "installCommand": "npm install",
  "devCommand": "npm run dev",
  "env": {
    "NEXT_PUBLIC_API_URL": "@api-url",
    "NEXT_PUBLIC_APP_URL": "@app-url"
  }
}
```

### åç«¯éƒ¨ç½² (Railway)
```dockerfile
# Dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

EXPOSE 3001

CMD ["npm", "start"]
```

### ç¯å¢ƒé…ç½®
```bash
# .env.production
NODE_ENV=production
PORT=3001
DATABASE_URL=mysql://user:password@host:port/database
REDIS_URL=redis://host:port
JWT_SECRET=your-jwt-secret
API_URL=https://api.bachelor-english-platform.com
FRONTEND_URL=https://bachelor-english-platform.com
```

## ğŸ“Š ç›‘æ§ä¸åˆ†æ

### åº”ç”¨ç›‘æ§
```typescript
// Sentryé›†æˆ
import * as Sentry from '@sentry/nextjs';

Sentry.init({
  dsn: process.env.SENTRY_DSN,
  environment: process.env.NODE_ENV,
  tracesSampleRate: 1.0,
});

// è‡ªå®šä¹‰é”™è¯¯è·Ÿè¸ª
const trackError = (error: Error, context: any) => {
  Sentry.captureException(error, {
    tags: {
      component: context.component,
      action: context.action,
    },
    extra: context,
  });
};
```

### æ€§èƒ½ç›‘æ§
```typescript
// æ€§èƒ½è·Ÿè¸ª
const trackPerformance = (metric: string, value: number) => {
  // å‘é€åˆ°åˆ†ææœåŠ¡
  analytics.track('performance_metric', {
    metric,
    value,
    timestamp: Date.now(),
  });
};

// APIå“åº”æ—¶é—´è·Ÿè¸ª
app.use((req, res, next) => {
  const start = Date.now();
  
  res.on('finish', () => {
    const duration = Date.now() - start;
    trackPerformance('api_response_time', duration);
  });
  
  next();
});
```

## ğŸ”„ CI/CDç®¡é“

### GitHub Actionså·¥ä½œæµ
```yaml
# .github/workflows/deploy.yml
name: éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm ci
      - run: npm run test
      - run: npm run lint

  deploy-frontend:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: amondnet/vercel-action@v20
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.ORG_ID }}
          vercel-project-id: ${{ secrets.PROJECT_ID }}

  deploy-backend:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: railway-app/railway-deploy@v1
        with:
          railway-token: ${{ secrets.RAILWAY_TOKEN }}
```

## ğŸ“± ç§»åŠ¨ç«¯ä¸PWAæ”¯æŒ

### æ¸è¿›å¼Webåº”ç”¨
```typescript
// next.config.js
const withPWA = require('next-pwa')({
  dest: 'public',
  register: true,
  skipWaiting: true,
});

module.exports = withPWA({
  // Next.jsé…ç½®
});

// æœåŠ¡å·¥ä½œè€…
self.addEventListener('fetch', (event) => {
  if (event.request.url.includes('/api/')) {
    event.respondWith(
      fetch(event.request).catch(() => {
        return new Response('ç¦»çº¿', { status: 503 });
      })
    );
  }
});
```

### å“åº”å¼è®¾è®¡
```css
/* ç§»åŠ¨ä¼˜å…ˆæ–¹æ³• */
.word-card {
  @apply w-full p-4;
}

@media (min-width: 768px) {
  .word-card {
    @apply w-1/2 p-6;
  }
}

@media (min-width: 1024px) {
  .word-card {
    @apply w-1/3 p-8;
  }
}
```

---

*æ­¤æŠ€æœ¯æ¶æ„ä¸ºæ„å»ºå¯æ‰©å±•ã€å¯ç»´æŠ¤å’Œé«˜æ€§èƒ½çš„å­¦ä½è‹±è¯­å­¦ä¹ å¹³å°æä¾›äº†åšå®åŸºç¡€ã€‚*
